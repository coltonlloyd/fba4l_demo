
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>FBA4L Demo</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=f0c89327" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=60c0e2ec"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'intro';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="#">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="None - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="None - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1 current active">
                <a class="reference internal" href="#">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/coltonlloyd/fba4l_demo" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/coltonlloyd/fba4l_demo/issues/new?title=Issue%20on%20page%20%2Fintro.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Welcome to your Jupyter Book</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="welcome-to-your-jupyter-book">
<h1>Welcome to your Jupyter Book<a class="headerlink" href="#welcome-to-your-jupyter-book" title="Link to this heading">#</a></h1>
<p>This is a small sample book to give you a feel for how book content is
structured.
It shows off a few of the major file types, as well as some sample content.
It does not go in-depth into any particular topic - check out <a class="reference external" href="https://jupyterbook.org">the Jupyter Book documentation</a> for more information.</p>
<p>Check out the content pages bundled with this sample book to see more.</p>
<div class="toctree-wrapper compound">
<span id="document-nb_examples/Intro to COBRApy_complete"></span><section class="tex2jax_ignore mathjax_ignore" id="cobrapy-tutorial">
<h2>COBRApy Tutorial<a class="headerlink" href="#cobrapy-tutorial" title="Link to this heading">#</a></h2>
<p>The purpose of this workflow is to describe the basic functions and methods of COBRApy by creating a simple model containing 1 reaction (Glucose-6-phosphate Isomerase).</p>
<p>COBRApy is a Python module that can be imported similar to any other python module</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cobra</span>
</pre></div>
</div>
</div>
</div>
<p>Use tab complete to show basic classes that can be accessed through the module. By convention classes are capitalized.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cobra</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>  <span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
    <span class="n">cobra</span><span class="o">.</span>
          <span class="o">^</span>
<span class="ne">SyntaxError</span>: invalid syntax
</pre></div>
</div>
</div>
</div>
<p>The main classes include:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cobra.Reaction</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cobra.Metabolite</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cobra.Model</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cobra.Gene</span></code></p></li>
</ol>
<hr class="docutils" />
<section id="a-create-an-empty-model">
<h3>A) Create an empty model<a class="headerlink" href="#a-create-an-empty-model" title="Link to this heading">#</a></h3>
<section id="instantiate-a-new-model-by-calling-model-using-test-model-as-the-model-id">
<h4>1) Instantiate a new model by calling Model  using “<code class="docutils literal notranslate"><span class="pre">test_model</span></code>” as the model id.<a class="headerlink" href="#instantiate-a-new-model-by-calling-model-using-test-model-as-the-model-id" title="Link to this heading">#</a></h4>
<p>You can view the documentation using the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cobra</span><span class="o">.</span><span class="n">Model</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Class representation for a cobra model

    Parameters
    ----------
    id_or_model : Model, string
        Either an existing Model object in which case a new model object is
        instantiated with the same properties as the original model,
        or an identifier to associate with the model as a string.
    name : string
        Human readable name for the model

    Attributes
    ----------
    reactions : DictList
        A DictList where the key is the reaction identifier and the value a
        Reaction
    metabolites : DictList
        A DictList where the key is the metabolite identifier and the value a
        Metabolite
    genes : DictList
        A DictList where the key is the gene identifier and the value a
        Gene
    groups : DictList
        A DictList where the key is the group identifier and the value a
        Group
    solution : Solution
        The last obtained solution from optimizing the model.

    
</pre></div>
</div>
</div>
</div>
<p>or</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cobra.Model<span class="o">?</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">&#39;test_model&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="see-the-contents-of-the-model-by-excuting-the-model-instance">
<h4>2) See the contents of the model by excuting the model instance<a class="headerlink" href="#see-the-contents-of-the-model-by-excuting-the-model-instance" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <table>
            <tr>
                <td><strong>Name</strong></td>
                <td>test_model</td>
            </tr><tr>
                <td><strong>Memory address</strong></td>
                <td>0x01614cd5e0</td>
            </tr><tr>
                <td><strong>Number of metabolites</strong></td>
                <td>0</td>
            </tr><tr>
                <td><strong>Number of reactions</strong></td>
                <td>0</td>
            </tr><tr>
                <td><strong>Number of groups</strong></td>
                <td>0</td>
            </tr><tr>
                <td><strong>Objective expression</strong></td>
                <td>0</td>
            </tr><tr>
                <td><strong>Compartments</strong></td>
                <td></td>
            </tr>
          </table></div></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="b-create-and-add-metabolites-to-model">
<h3>B) Create and add metabolites to model<a class="headerlink" href="#b-create-and-add-metabolites-to-model" title="Link to this heading">#</a></h3>
<section id="like-above-instantiate-a-new-metabolite-object-with-id-f6p-c">
<h4>1) Like above, instantiate a new Metabolite object with ID ‘<code class="docutils literal notranslate"><span class="pre">f6p_c</span></code>’<a class="headerlink" href="#like-above-instantiate-a-new-metabolite-object-with-id-f6p-c" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>By convention <code class="docutils literal notranslate"><span class="pre">_c</span></code> refers to the metabolite’s cellular compartment, in this case the cytosol</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cobra</span><span class="o">.</span><span class="n">Metabolite</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Metabolite is a class for holding information regarding
    a metabolite in a cobra.Reaction object.

    Parameters
    ----------
    id : str
        the identifier to associate with the metabolite
    formula : str
        Chemical formula (e.g. H2O)
    name : str
        A human readable name.
    charge : float
       The charge number of the metabolite
    compartment: str or None
       Compartment of the metabolite.
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metabolite_1</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Metabolite</span><span class="p">(</span><span class="s1">&#39;f6p_c&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metabolite_1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <table>
            <tr>
                <td><strong>Metabolite identifier</strong></td><td>f6p_c</td>
            </tr><tr>
                <td><strong>Name</strong></td><td></td>
            </tr><tr>
                <td><strong>Memory address</strong></td>
                <td>0x01614b3eb0</td>
            </tr><tr>
                <td><strong>Formula</strong></td><td>None</td>
            </tr><tr>
                <td><strong>Compartment</strong></td><td>None</td>
            </tr><tr>
                <td><strong>In 0 reaction(s)</strong></td><td>
                    </td>
            </tr>
        </table></div></div>
</div>
</section>
<section id="fill-in-the-missing-attributes-with-the-following-information">
<h4>2) Fill in the missing attributes with the following information<a class="headerlink" href="#fill-in-the-missing-attributes-with-the-following-information" title="Link to this heading">#</a></h4>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Attribute</p></th>
<th class="head text-center"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>name</p></td>
<td class="text-center"><p>D-Fructose 6-phosphate</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>compartment</p></td>
<td class="text-center"><p>Cytosol</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>formula</p></td>
<td class="text-center"><p>C6H11O9P</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>charge</p></td>
<td class="text-center"><p>-2</p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metabolite_1</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;D-Fructose 6-phosphate&#39;</span>
<span class="n">metabolite_1</span><span class="o">.</span><span class="n">compartment</span> <span class="o">=</span> <span class="s1">&#39;Cytosol&#39;</span>
<span class="n">metabolite_1</span><span class="o">.</span><span class="n">formula</span> <span class="o">=</span> <span class="s1">&#39;C6H11O9P&#39;</span>
<span class="n">metabolite_1</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="see-the-contents-of-the-metabolite-by-excuting-the-metabolite-instance">
<h4>3) See the contents of the metabolite by excuting the metabolite instance<a class="headerlink" href="#see-the-contents-of-the-metabolite-by-excuting-the-metabolite-instance" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metabolite_1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <table>
            <tr>
                <td><strong>Metabolite identifier</strong></td><td>f6p_c</td>
            </tr><tr>
                <td><strong>Name</strong></td><td>D-Fructose 6-phosphate</td>
            </tr><tr>
                <td><strong>Memory address</strong></td>
                <td>0x01614b3eb0</td>
            </tr><tr>
                <td><strong>Formula</strong></td><td>C6H11O9P</td>
            </tr><tr>
                <td><strong>Compartment</strong></td><td>Cytosol</td>
            </tr><tr>
                <td><strong>In 0 reaction(s)</strong></td><td>
                    </td>
            </tr>
        </table></div></div>
</div>
</section>
<section id="new-properties-can-be-calculated-from-attributes-for-example-access-the-metabolites-formula-weight-property">
<h4>4) New properties can be calculated from attributes. For example access the metabolites <code class="docutils literal notranslate"><span class="pre">formula_weight</span></code> property<a class="headerlink" href="#new-properties-can-be-calculated-from-attributes-for-example-access-the-metabolites-formula-weight-property" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Computed based on metabolite formula</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metabolite_1</span><span class="o">.</span><span class="n">formula_weight</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>258.119901
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-new-metabolite-with-following-attributes-assign-attributes-when-instantiating-the-metabolite">
<h4>5) Create new metabolite with following attributes. Assign attributes when instantiating the metabolite<a class="headerlink" href="#create-new-metabolite-with-following-attributes-assign-attributes-when-instantiating-the-metabolite" title="Link to this heading">#</a></h4>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Attribute</p></th>
<th class="head text-center"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>id</p></td>
<td class="text-center"><p>g6p_c</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>mame</p></td>
<td class="text-center"><p>D-Glusose 6-phosphate</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>compartment</p></td>
<td class="text-center"><p>Cytosol</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>formula</p></td>
<td class="text-center"><p>C6H11O9P</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>charge</p></td>
<td class="text-center"><p>-2</p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metabolite_2</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Metabolite</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;g6p_c&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;D-Glucose 6-phosphate&#39;</span><span class="p">,</span> <span class="n">compartment</span><span class="o">=</span><span class="s1">&#39;cytosol&#39;</span><span class="p">,</span> 
                                <span class="n">formula</span><span class="o">=</span><span class="s1">&#39;C6H11O9P&#39;</span><span class="p">,</span> <span class="n">charge</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metabolite_2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <table>
            <tr>
                <td><strong>Metabolite identifier</strong></td><td>g6p_c</td>
            </tr><tr>
                <td><strong>Name</strong></td><td>D-Glucose 6-phosphate</td>
            </tr><tr>
                <td><strong>Memory address</strong></td>
                <td>0x01614b3040</td>
            </tr><tr>
                <td><strong>Formula</strong></td><td>C6H11O9P</td>
            </tr><tr>
                <td><strong>Compartment</strong></td><td>cytosol</td>
            </tr><tr>
                <td><strong>In 0 reaction(s)</strong></td><td>
                    </td>
            </tr>
        </table></div></div>
</div>
</section>
<section id="add-both-metabolites-to-model-container">
<h4>6) Add both metabolites to model container<a class="headerlink" href="#add-both-metabolites-to-model-container" title="Link to this heading">#</a></h4>
<p>As with classes, we can observe the properties of functions like above</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>model.add_metabolites<span class="o">?</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">add_metabolites</span><span class="p">([</span><span class="n">metabolite_1</span><span class="p">,</span> <span class="n">metabolite_2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="see-contents-of-model-after-adding-metabolites">
<h4>7) See contents of model after adding metabolites<a class="headerlink" href="#see-contents-of-model-after-adding-metabolites" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <table>
            <tr>
                <td><strong>Name</strong></td>
                <td>test_model</td>
            </tr><tr>
                <td><strong>Memory address</strong></td>
                <td>0x01614cd5e0</td>
            </tr><tr>
                <td><strong>Number of metabolites</strong></td>
                <td>2</td>
            </tr><tr>
                <td><strong>Number of reactions</strong></td>
                <td>0</td>
            </tr><tr>
                <td><strong>Number of groups</strong></td>
                <td>0</td>
            </tr><tr>
                <td><strong>Objective expression</strong></td>
                <td>0</td>
            </tr><tr>
                <td><strong>Compartments</strong></td>
                <td>Cytosol, cytosol</td>
            </tr>
          </table></div></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="c-create-and-add-reaction-to-model">
<h3>C) Create and add reaction to model<a class="headerlink" href="#c-create-and-add-reaction-to-model" title="Link to this heading">#</a></h3>
<section id="like-the-model-and-metabolites-instantiate-a-reaction-with-id-pgi-and-name-glucose-6-phosphate-isomerase">
<h4>1) Like the model and metabolites, instantiate a reaction with id ‘<code class="docutils literal notranslate"><span class="pre">PGI</span></code>’ and name ‘<code class="docutils literal notranslate"><span class="pre">Glucose-6-phosphate</span> <span class="pre">isomerase</span></code>’<a class="headerlink" href="#like-the-model-and-metabolites-instantiate-a-reaction-with-id-pgi-and-name-glucose-6-phosphate-isomerase" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reaction</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;PGI&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Glucose-6-phosphate isomerase&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reaction</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="add-the-above-metabolites-to-the-reaction-as-a-dictionary">
<h4>2) Add the above metabolites to the reaction as a dictionary<a class="headerlink" href="#add-the-above-metabolites-to-the-reaction-as-a-dictionary" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stoichiometry</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;g6p_c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;f6p_c&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reaction</span><span class="o">.</span><span class="n">add_metabolites</span><span class="p">(</span><span class="n">stoichiometry</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Note:</strong> This produces and error because the reaction has not been added to the model yet. This means the reaction cannot access the metabolite information that we added above. So we must use either of the two approaches outlined in the error message.</p>
<ul class="simple">
<li><p><strong>Option 1</strong>: Use metabolite objects as keys</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metabolite_1</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">metabolites</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="s1">&#39;g6p_c&#39;</span><span class="p">)</span>
<span class="n">metabolite_2</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">metabolites</span><span class="o">.</span><span class="n">f6p_c</span>

<span class="n">reaction</span><span class="o">.</span><span class="n">add_metabolites</span><span class="p">({</span><span class="n">metabolite_1</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">metabolite_2</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Option 2</strong>: Use add reaction to model first</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">add_reactions</span><span class="p">([</span><span class="n">reaction</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># combine = false to not add coefficients </span>
<span class="n">reaction</span><span class="o">.</span><span class="n">add_metabolites</span><span class="p">({</span><span class="s1">&#39;g6p_c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;f6p_c&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">combine</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="view-contents-of-reaction">
<h4>3) View contents of reaction<a class="headerlink" href="#view-contents-of-reaction" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reaction</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="view-contents-of-model">
<h4>4) View contents of model<a class="headerlink" href="#view-contents-of-model" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">metabolites</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">reactions</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="make-the-reaction-reversible">
<h4>5) Make the reaction reversible<a class="headerlink" href="#make-the-reaction-reversible" title="Link to this heading">#</a></h4>
<p>The reaction has two attributes <strong><code class="docutils literal notranslate"><span class="pre">lower_bound</span></code></strong> and <strong><code class="docutils literal notranslate"><span class="pre">upper_bound</span></code></strong> which place limits on how much flux the reaction can carry in a simulation. By default, the reaction is set to be irreversible in the forward direction (1000 (w/ units of <span class="math notranslate nohighlight">\(\frac{mmol}{grams\_dry\_weight \cdot hr}\)</span> ) is used to effectively represent unbounded possible forward flux).</p>
<ul class="simple">
<li><p>To make the reaction reversible, set the <strong><code class="docutils literal notranslate"><span class="pre">lower_bound</span></code></strong> of the reaction to -1000</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reaction</span><span class="o">.</span><span class="n">lower_bound</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1000.</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="view-contents-of-the-reaction-noting-the-arrow-change">
<h4>6) View contents of the reaction noting the arrow change<a class="headerlink" href="#view-contents-of-the-reaction-noting-the-arrow-change" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reaction</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="d-associate-genes-to-reaction">
<h3>D) Associate genes to reaction<a class="headerlink" href="#d-associate-genes-to-reaction" title="Link to this heading">#</a></h3>
<p>Genes are linked to reactions via a <strong><code class="docutils literal notranslate"><span class="pre">gene_reaction_rule</span></code></strong> or <strong><code class="docutils literal notranslate"><span class="pre">GPR</span></code></strong>, above. There are boolean “OR” “AND” relationships that determine whether a reaction is knocked out based on the presence of genes in the model.</p>
<section id="first-set-the-gpr-as-an-or-relationship-with-two-genes-b1111-and-b2222">
<h4>1) First set the GPR as an OR relationship with two genes (b1111 and b2222)<a class="headerlink" href="#first-set-the-gpr-as-an-or-relationship-with-two-genes-b1111-and-b2222" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reaction</span><span class="o">.</span><span class="n">gene_reaction_rule</span> <span class="o">=</span> <span class="s1">&#39;b1111 or b2222&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="view-reaction-to-observe-addition-of-gpr">
<h4>2) View reaction to observe addition of GPR<a class="headerlink" href="#view-reaction-to-observe-addition-of-gpr" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reaction</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="access-gene-through-the-model">
<h4>3) Access gene through the model<a class="headerlink" href="#access-gene-through-the-model" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Gene is added to model automatically through the reaction</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">genes</span><span class="o">.</span><span class="n">b1111</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="simulate-gene-deletion-by-knocking-out-b1111-using-the-knock-out-gene-method">
<h4>4) Simulate gene deletion by knocking out b1111 using the <code class="docutils literal notranslate"><span class="pre">knock_out()</span></code> gene method<a class="headerlink" href="#simulate-gene-deletion-by-knocking-out-b1111-using-the-knock-out-gene-method" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">genes</span><span class="o">.</span><span class="n">b1111</span><span class="o">.</span><span class="n">knock_out</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="view-reaction-to-determine-if-knocked-out">
<h4>5) View reaction to determine if knocked out<a class="headerlink" href="#view-reaction-to-determine-if-knocked-out" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reaction</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kc">False</span> <span class="ow">or</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="change-gpr-to-and-relationship-with-same-two-genes">
<h4>6) Change GPR to “and” relationship with same two genes<a class="headerlink" href="#change-gpr-to-and-relationship-with-same-two-genes" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reaction</span><span class="o">.</span><span class="n">gene_reaction_rule</span> <span class="o">=</span> <span class="s1">&#39;b1111 and b2222&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="knock-out-b1111-again">
<h4>7) Knock out b1111 again<a class="headerlink" href="#knock-out-b1111-again" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">genes</span><span class="o">.</span><span class="n">b1111</span><span class="o">.</span><span class="n">knock_out</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="view-reaction-again-to-determine-if-knocked-out">
<h4>8) View reaction again to determine if knocked out<a class="headerlink" href="#view-reaction-again-to-determine-if-knocked-out" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reaction</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kc">False</span> <span class="ow">and</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="e-loading-and-solving-a-complete-model">
<h3>E) Loading and solving a complete model<a class="headerlink" href="#e-loading-and-solving-a-complete-model" title="Link to this heading">#</a></h3>
<p>Reconstructed M-models can be saved or loaded using a number of different standardized formats. For this workshop we will be using a model of <em>E. coli</em> K-12 MG1655 called iML1515. This is provided in a <code class="docutils literal notranslate"><span class="pre">JSON</span></code> format.</p>
<section id="load-model-using-cobra-io-load-json-model-function">
<h4>1) Load model using <code class="docutils literal notranslate"><span class="pre">cobra.io.load_json_model()</span></code> function<a class="headerlink" href="#load-model-using-cobra-io-load-json-model-function" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">full_model</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">load_json_model</span><span class="p">(</span><span class="s1">&#39;../resources/iML1515.json&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="view-iml1515-properties">
<h4>2) View iML1515 properties<a class="headerlink" href="#view-iml1515-properties" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">full_model</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="optimize-model-with-optimize-method">
<h4>3) Optimize model with <code class="docutils literal notranslate"><span class="pre">optimize()</span></code> method<a class="headerlink" href="#optimize-model-with-optimize-method" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">full_model</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="view-solution-using-escher-a-pathway-visualization-tool">
<h4>4) View solution using Escher, a pathway visualization tool<a class="headerlink" href="#view-solution-using-escher-a-pathway-visualization-tool" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">escher</span>
<span class="n">solution</span> <span class="o">=</span> <span class="n">full_model</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
<span class="n">builder</span> <span class="o">=</span> <span class="n">escher</span><span class="o">.</span><span class="n">Builder</span><span class="p">(</span><span class="n">map_json</span><span class="o">=</span><span class="s1">&#39;../resources/primer_iML_map.json&#39;</span><span class="p">)</span>
<span class="n">builder</span><span class="o">.</span><span class="n">reaction_data</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="n">builder</span><span class="o">.</span><span class="n">display_in_notebook</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<span id="document-nb_examples/pcca_example"></span><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">Dropdown</span><span class="p">,</span> <span class="n">RadioButtons</span><span class="p">,</span> <span class="n">VBox</span><span class="p">,</span> <span class="n">Output</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">cobra</span>
<span class="kn">from</span> <span class="nn">fba4l</span> <span class="kn">import</span> <span class="n">media</span>
<span class="kn">from</span> <span class="nn">escher</span> <span class="kn">import</span> <span class="n">Builder</span>
<span class="kn">from</span> <span class="nn">bokeh.io</span> <span class="kn">import</span> <span class="n">output_notebook</span><span class="p">,</span> <span class="n">show</span><span class="p">,</span> <span class="n">push_notebook</span>
<span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">ColumnDataSource</span><span class="p">,</span> <span class="n">FactorRange</span>
<span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">figure</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="n">output_notebook</span><span class="p">()</span>

<span class="c1"># ---------------------------------------</span>
<span class="c1"># Simulation: Run model for each media under both conditions</span>
<span class="c1"># ---------------------------------------</span>
<span class="n">fluxes_with</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">fluxes_without</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">summary</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">load_json_model</span><span class="p">(</span><span class="s1">&#39;/Users/coltonlloyd/fba4l/fba4l/models/core_model.json&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">EX_glc__D_c</span><span class="o">.</span><span class="n">knock_out</span><span class="p">()</span>

<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">media</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
        <span class="c1"># With PCCA:</span>
        <span class="k">with</span> <span class="n">model</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">lower_bound</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">sol</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
            <span class="n">fluxes_with</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">media</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">atp</span><span class="o">=</span><span class="n">sol</span><span class="o">.</span><span class="n">objective_value</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;with PCCA&#39;</span><span class="p">))</span>
        <span class="c1"># Without PCCA:</span>
        <span class="k">with</span> <span class="n">model</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">lower_bound</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">PPCOACm</span><span class="o">.</span><span class="n">knock_out</span><span class="p">()</span>
            <span class="n">sol</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
            <span class="n">fluxes_without</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">media</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">atp</span><span class="o">=</span><span class="n">sol</span><span class="o">.</span><span class="n">objective_value</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;without PCCA&#39;</span><span class="p">))</span>

<span class="c1"># Create a DataFrame summary for the bar plot</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;media&#39;</span><span class="p">)</span>

<span class="c1"># ---------------------------------------</span>
<span class="c1"># Bokeh Bar Plot: Show ATP yield for a chosen condition</span>
<span class="c1"># ---------------------------------------</span>
<span class="c1"># Start with one default condition (e.g., &quot;with PCCA&quot;)</span>
<span class="n">initial_condition</span> <span class="o">=</span> <span class="s1">&#39;with PCCA&#39;</span>
<span class="n">df_condition</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;kind&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">initial_condition</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># Instead of a tuple, define factor as just the media name.</span>
<span class="n">df_condition</span><span class="p">[</span><span class="s1">&#39;factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_condition</span><span class="p">[</span><span class="s1">&#39;media&#39;</span><span class="p">]</span>

<span class="n">source</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">df_condition</span><span class="p">)</span>
<span class="n">factors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_condition</span><span class="p">[</span><span class="s1">&#39;factor&#39;</span><span class="p">])</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">x_range</span><span class="o">=</span><span class="n">FactorRange</span><span class="p">(</span><span class="o">*</span><span class="n">factors</span><span class="p">),</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
           <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ATP Yield (</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">initial_condition</span><span class="p">,</span> <span class="n">toolbar_location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="c1"># For a single condition, use a fixed color.</span>
<span class="n">p</span><span class="o">.</span><span class="n">vbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;factor&#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="s1">&#39;atp&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
       <span class="n">fill_color</span><span class="o">=</span><span class="s2">&quot;#718dbf&quot;</span><span class="p">)</span>

<span class="c1"># Rotate x-axis labels by 45 degrees</span>
<span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">major_label_orientation</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">xgrid</span><span class="o">.</span><span class="n">grid_line_color</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">bokeh_handle</span> <span class="o">=</span> <span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">notebook_handle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># ---------------------------------------</span>
<span class="c1"># Escher Map: Create an Escher Builder for flux visualization</span>
<span class="c1"># ---------------------------------------</span>
<span class="n">default_media</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fluxes_with</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">builder</span> <span class="o">=</span> <span class="n">Builder</span><span class="p">(</span><span class="n">map_json</span><span class="o">=</span><span class="s1">&#39;/Users/coltonlloyd/fba4l/fba4l/maps/core_map_v30.json&#39;</span><span class="p">,</span> 
                  <span class="n">reaction_data</span><span class="o">=</span><span class="n">fluxes_with</span><span class="p">[</span><span class="n">default_media</span><span class="p">])</span>

<span class="n">builder</span><span class="o">.</span><span class="n">reaction_scale</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">escher_out</span> <span class="o">=</span> <span class="n">Output</span><span class="p">()</span>
<span class="k">with</span> <span class="n">escher_out</span><span class="p">:</span>
    <span class="n">display</span><span class="p">(</span><span class="n">builder</span><span class="p">)</span>

<span class="c1"># ---------------------------------------</span>
<span class="c1"># ipywidgets for interactive toggling</span>
<span class="c1"># ---------------------------------------</span>
<span class="n">condition_widget</span> <span class="o">=</span> <span class="n">RadioButtons</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;with PCCA&#39;</span><span class="p">,</span> <span class="s1">&#39;without PCCA&#39;</span><span class="p">],</span>
                                <span class="n">value</span><span class="o">=</span><span class="n">initial_condition</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Condition:&#39;</span><span class="p">)</span>
<span class="n">media_widget</span> <span class="o">=</span> <span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">fluxes_with</span><span class="o">.</span><span class="n">keys</span><span class="p">())),</span>
                        <span class="n">value</span><span class="o">=</span><span class="n">default_media</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Media:&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update_outputs</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
    <span class="c1"># Get current selections</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="n">condition_widget</span><span class="o">.</span><span class="n">value</span>
    <span class="n">med</span> <span class="o">=</span> <span class="n">media_widget</span><span class="o">.</span><span class="n">value</span>

    <span class="c1"># --- Update Bokeh bar plot ---</span>
    <span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;kind&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">cond</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1"># Use only the media name as factor.</span>
    <span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;media&#39;</span><span class="p">]</span>
    <span class="n">new_factors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;factor&#39;</span><span class="p">])</span>
    <span class="n">source</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">df_new</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">x_range</span><span class="o">.</span><span class="n">factors</span> <span class="o">=</span> <span class="n">new_factors</span>
    <span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;ATP Yield (</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">cond</span>

    <span class="c1"># --- Update Escher map ---</span>
    <span class="n">flux_data</span> <span class="o">=</span> <span class="n">fluxes_with</span><span class="p">[</span><span class="n">med</span><span class="p">]</span> <span class="k">if</span> <span class="n">cond</span> <span class="o">==</span> <span class="s1">&#39;with PCCA&#39;</span> <span class="k">else</span> <span class="n">fluxes_without</span><span class="p">[</span><span class="n">med</span><span class="p">]</span>
    <span class="n">builder</span><span class="o">.</span><span class="n">reaction_data</span> <span class="o">=</span> <span class="n">flux_data</span>

    <span class="n">push_notebook</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">bokeh_handle</span><span class="p">)</span>

<span class="c1"># Attach the update function to both widgets</span>
<span class="n">condition_widget</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update_outputs</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
<span class="n">media_widget</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update_outputs</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="c1"># ---------------------------------------</span>
<span class="c1"># Display all interactive elements in the notebook</span>
<span class="c1"># ---------------------------------------</span>
<span class="n">ui</span> <span class="o">=</span> <span class="n">VBox</span><span class="p">([</span><span class="n">condition_widget</span><span class="p">,</span> <span class="n">media_widget</span><span class="p">,</span> <span class="n">escher_out</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">ui</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">    <style>
        .bk-notebook-logo {
            display: block;
            width: 20px;
            height: 20px;
            background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAOkSURBVDiNjZRtaJVlGMd/1/08zzln5zjP1LWcU9N0NkN8m2CYjpgQYQXqSs0I84OLIC0hkEKoPtiH3gmKoiJDU7QpLgoLjLIQCpEsNJ1vqUOdO7ppbuec5+V+rj4ctwzd8IIbbi6u+8f1539dt3A78eXC7QizUF7gyV1fD1Yqg4JWz84yffhm0qkFqBogB9rM8tZdtwVsPUhWhGcFJngGeWrPzHm5oaMmkfEg1usvLFyc8jLRqDOMru7AyC8saQr7GG7f5fvDeH7Ej8CM66nIF+8yngt6HWaKh7k49Soy9nXurCi1o3qUbS3zWfrYeQDTB/Qj6kX6Ybhw4B+bOYoLKCC9H3Nu/leUTZ1JdRWkkn2ldcCamzrcf47KKXdAJllSlxAOkRgyHsGC/zRday5Qld9DyoM4/q/rUoy/CXh3jzOu3bHUVZeU+DEn8FInkPBFlu3+nW3Nw0mk6vCDiWg8CeJaxEwuHS3+z5RgY+YBR6V1Z1nxSOfoaPa4LASWxxdNp+VWTk7+4vzaou8v8PN+xo+KY2xsw6une2frhw05CTYOmQvsEhjhWjn0bmXPjpE1+kplmmkP3suftwTubK9Vq22qKmrBhpY4jvd5afdRA3wGjFAgcnTK2s4hY0/GPNIb0nErGMCRxWOOX64Z8RAC4oCXdklmEvcL8o0BfkNK4lUg9HTl+oPlQxdNo3Mg4Nv175e/1LDGzZen30MEjRUtmXSfiTVu1kK8W4txyV6BMKlbgk3lMwYCiusNy9fVfvvwMxv8Ynl6vxoByANLTWplvuj/nF9m2+PDtt1eiHPBr1oIfhCChQMBw6Aw0UulqTKZdfVvfG7VcfIqLG9bcldL/+pdWTLxLUy8Qq38heUIjh4XlzZxzQm19lLFlr8vdQ97rjZVOLf8nclzckbcD4wxXMidpX30sFd37Fv/GtwwhzhxGVAprjbg0gCAEeIgwCZyTV2Z1REEW8O4py0wsjeloKoMr6iCY6dP92H6Vw/oTyICIthibxjm/DfN9lVz8IqtqKYLUXfoKVMVQVVJOElGjrnnUt9T9wbgp8AyYKaGlqingHZU/uG2NTZSVqwHQTWkx9hxjkpWDaCg6Ckj5qebgBVbT3V3NNXMSiWSDdGV3hrtzla7J+duwPOToIg42ChPQOQjspnSlp1V+Gjdged7+8UN5CRAV7a5EdFNwCjEaBR27b3W890TE7g24NAP/mMDXRWrGoFPQI9ls/MWO2dWFAar/xcOIImbbpA3zgAAAABJRU5ErkJggg==);
        }
    </style>
    <div>
        <a href="https://bokeh.org" target="_blank" class="bk-notebook-logo"></a>
        <span id="ab72b2c9-be7a-4094-928e-0352be13c9f6">Loading BokehJS ...</span>
    </div>
</div><script type="application/javascript">'use strict';
(function(root) {
  function now() {
    return new Date();
  }

  const force = true;

  if (typeof root._bokeh_onload_callbacks === "undefined" || force === true) {
    root._bokeh_onload_callbacks = [];
    root._bokeh_is_loading = undefined;
  }

const JS_MIME_TYPE = 'application/javascript';
  const HTML_MIME_TYPE = 'text/html';
  const EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json';
  const CLASS_NAME = 'output_bokeh rendered_html';

  /**
   * Render data to the DOM node
   */
  function render(props, node) {
    const script = document.createElement("script");
    node.appendChild(script);
  }

  /**
   * Handle when an output is cleared or removed
   */
  function handleClearOutput(event, handle) {
    function drop(id) {
      const view = Bokeh.index.get_by_id(id)
      if (view != null) {
        view.model.document.clear()
        Bokeh.index.delete(view)
      }
    }

    const cell = handle.cell;

    const id = cell.output_area._bokeh_element_id;
    const server_id = cell.output_area._bokeh_server_id;

    // Clean up Bokeh references
    if (id != null) {
      drop(id)
    }

    if (server_id !== undefined) {
      // Clean up Bokeh references
      const cmd_clean = "from bokeh.io.state import curstate; print(curstate().uuid_to_server['" + server_id + "'].get_sessions()[0].document.roots[0]._id)";
      cell.notebook.kernel.execute(cmd_clean, {
        iopub: {
          output: function(msg) {
            const id = msg.content.text.trim()
            drop(id)
          }
        }
      });
      // Destroy server and session
      const cmd_destroy = "import bokeh.io.notebook as ion; ion.destroy_server('" + server_id + "')";
      cell.notebook.kernel.execute(cmd_destroy);
    }
  }

  /**
   * Handle when a new output is added
   */
  function handleAddOutput(event, handle) {
    const output_area = handle.output_area;
    const output = handle.output;

    // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only
    if ((output.output_type != "display_data") || (!Object.prototype.hasOwnProperty.call(output.data, EXEC_MIME_TYPE))) {
      return
    }

    const toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);

    if (output.metadata[EXEC_MIME_TYPE]["id"] !== undefined) {
      toinsert[toinsert.length - 1].firstChild.textContent = output.data[JS_MIME_TYPE];
      // store reference to embed id on output_area
      output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE]["id"];
    }
    if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
      const bk_div = document.createElement("div");
      bk_div.innerHTML = output.data[HTML_MIME_TYPE];
      const script_attrs = bk_div.children[0].attributes;
      for (let i = 0; i < script_attrs.length; i++) {
        toinsert[toinsert.length - 1].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value);
        toinsert[toinsert.length - 1].firstChild.textContent = bk_div.children[0].textContent
      }
      // store reference to server id on output_area
      output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
    }
  }

  function register_renderer(events, OutputArea) {

    function append_mime(data, metadata, element) {
      // create a DOM node to render to
      const toinsert = this.create_output_subarea(
        metadata,
        CLASS_NAME,
        EXEC_MIME_TYPE
      );
      this.keyboard_manager.register_events(toinsert);
      // Render to node
      const props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
      render(props, toinsert[toinsert.length - 1]);
      element.append(toinsert);
      return toinsert
    }

    /* Handle when an output is cleared or removed */
    events.on('clear_output.CodeCell', handleClearOutput);
    events.on('delete.Cell', handleClearOutput);

    /* Handle when a new output is added */
    events.on('output_added.OutputArea', handleAddOutput);

    /**
     * Register the mime type and append_mime function with output_area
     */
    OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
      /* Is output safe? */
      safe: true,
      /* Index of renderer in `output_area.display_order` */
      index: 0
    });
  }

  // register the mime type if in Jupyter Notebook environment and previously unregistered
  if (root.Jupyter !== undefined) {
    const events = require('base/js/events');
    const OutputArea = require('notebook/js/outputarea').OutputArea;

    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  }
  if (typeof (root._bokeh_timeout) === "undefined" || force === true) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  const NB_LOAD_WARNING = {'data': {'text/html':
     "<div style='background-color: #fdd'>\n"+
     "<p>\n"+
     "BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \n"+
     "may be due to a slow or bad network connection. Possible fixes:\n"+
     "</p>\n"+
     "<ul>\n"+
     "<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\n"+
     "<li>use INLINE resources instead, as so:</li>\n"+
     "</ul>\n"+
     "<code>\n"+
     "from bokeh.resources import INLINE\n"+
     "output_notebook(resources=INLINE)\n"+
     "</code>\n"+
     "</div>"}};

  function display_loaded(error = null) {
    const el = document.getElementById("ab72b2c9-be7a-4094-928e-0352be13c9f6");
    if (el != null) {
      const html = (() => {
        if (typeof root.Bokeh === "undefined") {
          if (error == null) {
            return "BokehJS is loading ...";
          } else {
            return "BokehJS failed to load.";
          }
        } else {
          const prefix = `BokehJS ${root.Bokeh.version}`;
          if (error == null) {
            return `${prefix} successfully loaded.`;
          } else {
            return `${prefix} <b>encountered errors</b> while loading and may not function as expected.`;
          }
        }
      })();
      el.innerHTML = html;

      if (error != null) {
        const wrapper = document.createElement("div");
        wrapper.style.overflow = "auto";
        wrapper.style.height = "5em";
        wrapper.style.resize = "vertical";
        const content = document.createElement("div");
        content.style.fontFamily = "monospace";
        content.style.whiteSpace = "pre-wrap";
        content.style.backgroundColor = "rgb(255, 221, 221)";
        content.textContent = error.stack ?? error.toString();
        wrapper.append(content);
        el.append(wrapper);
      }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(() => display_loaded(error), 100);
    }
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];

    root._bokeh_onload_callbacks.push(callback);
    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls == null || js_urls.length === 0) {
      run_callbacks();
      return null;
    }
    console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    root._bokeh_is_loading = css_urls.length + js_urls.length;

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }

    function on_error(url) {
      console.error("failed to load " + url);
    }

    for (let i = 0; i < css_urls.length; i++) {
      const url = css_urls[i];
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error.bind(null, url);
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }

    for (let i = 0; i < js_urls.length; i++) {
      const url = js_urls[i];
      const element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error.bind(null, url);
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  const js_urls = ["https://cdn.bokeh.org/bokeh/release/bokeh-3.4.3.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-gl-3.4.3.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.4.3.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.4.3.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-mathjax-3.4.3.min.js"];
  const css_urls = [];

  const inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {
    }
  ];

  function run_inline_js() {
    if (root.Bokeh !== undefined || force === true) {
      try {
            for (let i = 0; i < inline_js.length; i++) {
      inline_js[i].call(root, root.Bokeh);
    }

      } catch (error) {display_loaded(error);throw error;
      }if (force === true) {
        display_loaded();
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    } else if (force !== true) {
      const cell = $(document.getElementById("ab72b2c9-be7a-4094-928e-0352be13c9f6")).parents('.cell').data().cell;
      cell.output_area.append_execute_result(NB_LOAD_WARNING)
    }
  }

  if (root._bokeh_is_loading === 0) {
    console.debug("Bokeh: BokehJS loaded, going straight to plotting");
    run_inline_js();
  } else {
    load_libs(css_urls, js_urls, function() {
      console.debug("Bokeh: BokehJS plotting callback run at", now());
      run_inline_js();
    });
  }
}(window));</script><div class="output text_html">
  <div id="b418bc0b-ca51-4a85-a74b-b356a87fdba1" data-root-id="p1005" style="display: contents;"></div>
</div><script type="application/javascript">(function(root) {
  function embed_document(root) {
  const docs_json = {"c8f81ce4-d9ab-46ab-99e1-21216aea9d3d":{"version":"3.4.3","title":"Bokeh Application","roots":[{"type":"object","name":"Figure","id":"p1005","attributes":{"width":800,"height":400,"x_range":{"type":"object","name":"FactorRange","id":"p1004","attributes":{"factors":["EX_ala__L_c","EX_arg__L_c","EX_asn__L_c","EX_asp__L_c","EX_atp_c","EX_bhb_c","EX_cys__L_c","EX_etoh_c","EX_fru_c","EX_glc__D_c","EX_gln__L_c","EX_glu__L_c","EX_gly_c","EX_glyc_3octa_c","EX_glyc_c","EX_ile__L_c","EX_lac__L_c","EX_leu__L_c","EX_met__L_c","EX_octa_c","EX_ppa_c","EX_pro__L_c","EX_pyr_c","EX_ser__L_c","EX_utp_c"]}},"y_range":{"type":"object","name":"DataRange1d","id":"p1007"},"x_scale":{"type":"object","name":"CategoricalScale","id":"p1015"},"y_scale":{"type":"object","name":"LinearScale","id":"p1016"},"title":{"type":"object","name":"Title","id":"p1008","attributes":{"text":"ATP Yield (with PCCA)"}},"renderers":[{"type":"object","name":"GlyphRenderer","id":"p1033","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1001","attributes":{"selected":{"type":"object","name":"Selection","id":"p1002","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1003"},"data":{"type":"map","entries":[["index",{"type":"ndarray","array":{"type":"bytes","data":"EgAAABoAAAAkAAAAIgAAACgAAAAIAAAADgAAABQAAAAWAAAAGAAAAAYAAAAKAAAAEAAAAC4AAAAwAAAAHgAAAAAAAAAgAAAALAAAAAQAAAAmAAAAHAAAAAIAAAAMAAAAKgAAAA=="},"shape":[25],"dtype":"int32","order":"little"}],["media",{"type":"ndarray","array":["EX_ala__L_c","EX_arg__L_c","EX_asn__L_c","EX_asp__L_c","EX_atp_c","EX_bhb_c","EX_cys__L_c","EX_etoh_c","EX_fru_c","EX_glc__D_c","EX_gln__L_c","EX_glu__L_c","EX_gly_c","EX_glyc_3octa_c","EX_glyc_c","EX_ile__L_c","EX_lac__L_c","EX_leu__L_c","EX_met__L_c","EX_octa_c","EX_ppa_c","EX_pro__L_c","EX_pyr_c","EX_ser__L_c","EX_utp_c"],"shape":[25],"dtype":"object","order":"little"}],["atp",{"type":"ndarray","array":{"type":"bytes","data":"mpmZmZmZI0BmZmZmZmYxQAAAAAAAACBAzczMzMzMI0DIzMzMzMwxQAAAAAAAADFAZmZmZmZmJEBmZmZmZmYkQDMzMzMzMzlAMjMzMzMzOUCamZmZmZkrQJqZmZmZmS9ANDMzMzMzD0BmZmZmZqZgQLvMzMzMzCxAZmZmZmZmOkA5MzMzMzMnQJqZmZmZmTlAAAAAAACAMUDNzMzMzMxDQDMzMzMzMydAMzMzMzMzM0CgmZmZmZkjQDQzMzMzMx9AVGZmZmbmPUA="},"shape":[25],"dtype":"float64","order":"little"}],["kind",{"type":"ndarray","array":["with PCCA","with PCCA","with PCCA","with PCCA","with PCCA","with PCCA","with PCCA","with PCCA","with PCCA","with PCCA","with PCCA","with PCCA","with PCCA","with PCCA","with PCCA","with PCCA","with PCCA","with PCCA","with PCCA","with PCCA","with PCCA","with PCCA","with PCCA","with PCCA","with PCCA"],"shape":[25],"dtype":"object","order":"little"}],["factor",{"type":"ndarray","array":["EX_ala__L_c","EX_arg__L_c","EX_asn__L_c","EX_asp__L_c","EX_atp_c","EX_bhb_c","EX_cys__L_c","EX_etoh_c","EX_fru_c","EX_glc__D_c","EX_gln__L_c","EX_glu__L_c","EX_gly_c","EX_glyc_3octa_c","EX_glyc_c","EX_ile__L_c","EX_lac__L_c","EX_leu__L_c","EX_met__L_c","EX_octa_c","EX_ppa_c","EX_pro__L_c","EX_pyr_c","EX_ser__L_c","EX_utp_c"],"shape":[25],"dtype":"object","order":"little"}]]}}},"view":{"type":"object","name":"CDSView","id":"p1034","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1035"}}},"glyph":{"type":"object","name":"VBar","id":"p1030","attributes":{"x":{"type":"field","field":"factor"},"width":{"type":"value","value":0.8},"top":{"type":"field","field":"atp"},"line_color":{"type":"value","value":"white"},"fill_color":{"type":"value","value":"#718dbf"}}},"nonselection_glyph":{"type":"object","name":"VBar","id":"p1031","attributes":{"x":{"type":"field","field":"factor"},"width":{"type":"value","value":0.8},"top":{"type":"field","field":"atp"},"line_color":{"type":"value","value":"white"},"line_alpha":{"type":"value","value":0.1},"fill_color":{"type":"value","value":"#718dbf"},"fill_alpha":{"type":"value","value":0.1},"hatch_alpha":{"type":"value","value":0.1}}},"muted_glyph":{"type":"object","name":"VBar","id":"p1032","attributes":{"x":{"type":"field","field":"factor"},"width":{"type":"value","value":0.8},"top":{"type":"field","field":"atp"},"line_color":{"type":"value","value":"white"},"line_alpha":{"type":"value","value":0.2},"fill_color":{"type":"value","value":"#718dbf"},"fill_alpha":{"type":"value","value":0.2},"hatch_alpha":{"type":"value","value":0.2}}}}}],"toolbar":{"type":"object","name":"Toolbar","id":"p1014"},"toolbar_location":null,"left":[{"type":"object","name":"LinearAxis","id":"p1022","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1023","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1024"},"major_label_policy":{"type":"object","name":"AllLabels","id":"p1025"}}}],"below":[{"type":"object","name":"CategoricalAxis","id":"p1017","attributes":{"ticker":{"type":"object","name":"CategoricalTicker","id":"p1018"},"formatter":{"type":"object","name":"CategoricalTickFormatter","id":"p1019"},"major_label_orientation":0.7853981633974483,"major_label_policy":{"type":"object","name":"AllLabels","id":"p1020"}}}],"center":[{"type":"object","name":"Grid","id":"p1021","attributes":{"axis":{"id":"p1017"},"grid_line_color":null}},{"type":"object","name":"Grid","id":"p1026","attributes":{"dimension":1,"axis":{"id":"p1022"}}}]}}]}};
  const render_items = [{"docid":"c8f81ce4-d9ab-46ab-99e1-21216aea9d3d","roots":{"p1005":"b418bc0b-ca51-4a85-a74b-b356a87fdba1"},"root_ids":["p1005"],"notebook_comms_target":"p1036"}];
  void root.Bokeh.embed.embed_items_notebook(docs_json, render_items);
  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    let attempts = 0;
    const timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "65afc2ff650e4b4cbb854dafd8752066"}</script></div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "coltonlloyd/fba4l_demo",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Colton Lloyd and Bernhard Palsson
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>